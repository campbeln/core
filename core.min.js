/*
ishJS Functionality
By: Nick Campbell
License: MIT
*/
!function(){"use strict";var a,e,b={$unstable:{},$ver:"0.8.2017-02-10",$ish:!0},c=window,d=document,f=!0,g=!1,h=Object.prototype.toString;Date.now||(Date.now=function(){return new Date}),b.resolve=function(){var a,c,d,h,i,j,k,l,m,n={allowFn:!0},o=arguments;if(o[0]===f?(m=f,h=o[1],d=o[2],o.length>3&&(l=f,c=o[3])):(m=g,h=o[0],d=o[1],o.length>2&&(l=f,c=o[2])),a=b.is.obj(h,n)?h:e,a&&(b.is.str(d)||b.is.arr(d,!0)&&b.is.str(d[0]))){for(i=b.is.arr(d)?d:d.split("."),j=0;j<i.length;j++)if(k=b.is.obj(a,n))if(i[j]in a)h=a,a=h[i[j]];else{if(!m){a=e;break}h=a,a=h[i[j]]={}}else if(m)h[i[j]]=a={};else if(j<i.length-1){a=e;break}l&&a&&(h[i[i.length-1]]=a=c)}return a},b.extend=function(){var a,c,d,e,f,g,h=arguments,i=b.is.bool(h[0]);for(i||b.is.num(h[0])?(e=i?-1:b.mk.int(h[0]),a=h[1],f=2):(e=0,a=h[0],f=1),a=b.is.obj(a,{allowFn:!0})?a:{};f<h.length;f++){c=h[f];for(d in c)if(Object.prototype.hasOwnProperty.call(c,d))if(b.is.arr(c[d]))for(a[d]=[],g=0;g<c[d].length;g++)a[d].push(0!==e&&b.is.obj(c[d][g])?b.extend(e-1,{},c[d][g]):c[d][g]);else a[d]=0!==e&&b.is.obj(c[d])?b.extend(e-1,{},c[d]):c[d]}return a},b.locate=function(e){var g,h,i,j,k=!1;for(i in c)if(g=c[i],c.hasOwnProperty(i)&&b.is.obj(g)&&e in g){h=g[e],e=b.is.str(h,f)?i+"."+h:i,k=!0;break}if(!k)for(h=d.getElementsByTagName("SCRIPT"),j=0;j<h.length;j++)if(g=b.queryString.parse(h[j].src),i=b.data.getKey(e,g,!0),b.is.str(i,!0)){e=i;break}return{path:e,ref:b.resolve(f,c,e)}},b.is={str:function(a,c,d){return b.mk.bool(!(!("string"==typeof a||a instanceof String)||c&&""===a||d&&""===b.mk.str(a).trim()))},date:function(a){var c=new Date(a);return b.mk.bool(a&&"[object Date]"===h.call(c)&&!isNaN(c.valueOf()))},num:function(a){return b.mk.bool(/^[-0-9]?[0-9]*(\.[0-9]{1,})?$/.test(a)&&!isNaN(parseFloat(a))&&isFinite(a))},int:function(a){var c=b.mk.float(a);return b.is.num(a)&&c%1===0},float:function(a){var c=b.mk.float(a);return b.is.num(a)&&c%1!==0},bool:function(a){return b.mk.bool("[object Boolean]"===h.call(a))},true:function(a){return b.mk.bool(a===f?f:"true"===(a+"").trim().toLowerCase())},fn:function(a){return b.mk.bool("[object Function]"===h.call(a))},obj:function(a,c){var d,e=c&&c===Object(c)?c:{},h=e.requiredKeys,i=e.nonEmpty===f,j=e.allowFn===f,k=b.mk.bool(a&&a===Object(a)&&(j||!b.is.fn(a)));if(k&&(k=b.mk.bool(!i||0!==Object.getOwnPropertyNames(a).length),k&&h))for(d=0;d<h.length;d++)if(!a.hasOwnProperty(h[0])){k=g;break}return k},arr:function(a,c){return b.mk.bool("[object Array]"===h.call(a)&&(!c||a.length>0))},val:function(a){return b.mk.bool(a!==e&&null!==a)},type:function(a,b){try{return a instanceof b}catch(a){return g}},json:function(a){try{return JSON.parse(a),f}catch(a){return g}},dom:function(a){return b.mk.bool(a&&b.is.str(a.tagName)&&""!==a.tagName&&b.is.fn(a.getAttribute))}},b.mk={str:function(a,b){var c=a+"";return a&&c?c:arguments.length>1?b:""},date:function(a,c){return b.is.date(a)?new Date(a):arguments.length>1?c:new Date},int:function(a,b){var c=parseInt(a,10);return isNaN(c)?arguments.length>1?b:0:c},float:function(a,b){var c=parseFloat(a,10);return isNaN(c)?arguments.length>1?b:0:c},arr:function(a,c){return b.is.arr(a)?a:arguments.length>1?c:[]},obj:function(a,c){var d=b.is.fn(a)&&b.is.obj(a,{nonEmpty:f,allowFn:f});return d&&(a=b.extend({},a)),d||b.is.obj(a)?a:arguments.length>1?c:{}},bool:function(a){return a?f:g},age:function(a){var c,d=-1;return b.is.date(a)&&(c=new Date(Date.now()-b.mk.date(a,null)),d=Math.abs(c.getUTCFullYear()-1970)),d},yyyymmdd:function(a,c){var d=b.mk.date(a,arguments.length>1?c:new Date);return b.is.date(d)?d.getFullYear()+"/"+b.data.str.lpad(d.getMonth()+1,"0",2)+"/"+b.data.str.lpad(d.getDate(),"0",2):""},dateOnly:function(a,c){return b.mk.date(b.mk.yyyymmdd.apply(this,arguments)+" 00:00:00")},json:function(a,c){var d=arguments.length>1?c:{};if(b.is.str(a,f))try{d=JSON.parse(a)}catch(a){}else if(b.is.obj(a))try{d=JSON.stringify(a)}catch(a){}return d}},b.eq={date:function(a,c){var d=b.mk.date(a,null),e=b.mk.date(c,null);return b.is.date(d)&&b.is.date(e)&&d<=e&&d>=e},num:function(a,c){var d=g;return b.is.num(a)&&b.is.num(c)&&(d=b.mk.float(a)===b.mk.float(c)),d},str:function(a,c,d){return a=b.mk.str(a,""),c=b.mk.str(c,""),d!==g?a.toLowerCase()===c.toLowerCase():a===c}},b.comp={date:function(a,c){var d=e,f=b.mk.date(a,null),g=arguments.length<2?new Date:b.mk.date(c,null);return b.is.date(f)&&b.is.date(g)&&(d=f<g?-1:f>g?1:0),d},num:function(a,c){var d=e,f=b.mk.float(a,null),g=b.mk.float(c,null);return b.is.num(f)&&b.is.num(g)&&(d=f<g?-1:f>g?1:0),d},str:function(a,c){var d=g,e=b.mk.str(a),h=b.mk.str(c);return e===h?d=f:e.trim().toLowerCase()===h.trim().toLowerCase()&&(d=1),d}},b.fn={call:function(a,c,d){if(b.is.fn(a))return a.apply(c||this,b.is.arr(d)?d:[d])},tryCatch:function(a,c,d,e,f){var g={result:e,error:null};try{g.result=a.apply(c||this,b.is.arr(d)?d:[d])}catch(a){g.error=a}return f?g:g.result},throttle:function(a,c,d){var e,f,h,i=null,j=0;d=b.mk.obj(d);var k=function(){j=d.leading===g?0:Date.now(),i=null,h=a.apply(e,f),i||(e=f=null)};return function(){var b,l=Date.now();return j||d.leading!==g||(j=l),b=c-(l-j),e=this,f=arguments,b<=0||b>c?(i&&(clearTimeout(i),i=null),j=l,h=a.apply(e,f),i||(e=f=null)):i||d.trailing===g||(i=setTimeout(k,b)),h}},debounce:function(a,b,c){var d,e,f,g,h,i=function(){var j=Date.now()-g;j<b&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){var j=c&&!d;return f=this,e=arguments,g=Date.now(),d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},poll:function(a,c,d,e,f,g){var h=Number(new Date)+(e||2e3);f=f||100,!function e(){a===!0&&b.is.fn(c)?c(g):b.fn.call(a,this,g)?c(g):Number(new Date)<h?setTimeout(e,f):b.is.fn(d)&&d(new Error("timed out for "+c+": "+arguments),g)}()},noop:function(){},once:function(a,c,d){var e;return function(){return b.is.fn(a)&&(e=a.apply(c||this,b.is.arr(d)?d:[d]),a=null),e}}},!function(){var a,c;b.net={ping:function(a){c||(c=d.createElement("iframe")),c.src=a},absoluteUrl:function(b){return a||(a=d.createElement("a")),a.href=b,a.href}}}(),!function(){function e(c,d){c<=a.logLevel&&(b.is.str(a.url,f)&&b.ui.ping(a.url),b.fn.call(a.callback,this,d))}function h(c,f,g,h,i){return e(d.error,arguments),b.mk.bool(a.surpressErrors)}var a,d={error:1,warn:2,log:3};b.log={options:function(e){a=b.extend({severity:d,logLevel:d.error,logAllErrors:g,surpressErrors:f,callback:null,url:null},e),a.logAllErrors?b.fn.tryCatch(function(){c.onerror=h},this,[],{}):c.onerror=null},raise:function(a){throw e(d.error,a),a},warn:function(){e(d.warn,arguments);try{c.console&&b.is.fn(c.console.warn)?c.console.warn.apply(this,arguments):b.log.console.apply(this,arguments)}catch(a){}},console:function(){e(d.log,arguments);try{c.console.log.apply(this,arguments)}catch(a){}}}}(),!function(){var a={$keys:[]};b.cookie=function(c,h,i){function l(){var a,b,e=d.cookie.split(";");for(a=0;a<e.length;a++)if(b=e[a].indexOf("="),c===e[a].substr(0,b).replace(/^\s+|\s+$/g,"")){k.original=decodeURIComponent(e[a].substr(b+1));try{j=k.original?JSON.parse(k.original):{}}catch(a){j={}}return f}return g}var j,k={name:c,original:null,string:function(){return JSON.stringify(k.data)},data:null,isNew:f,set:function(a,b,i){var j;return a===e&&(a=1008e4),a>0&&(j=new Date,j.setSeconds(j.getSeconds()+a)),b=b||"/",h.maxAge=a,h.path=b,h.domain=i,d.cookie=c+"="+encodeURIComponent(k.string())+"; path="+b+(a>0?"; max-age="+a:"")+(j?"; expires="+j.toUTCString():"")+(i?"; domain="+i:"")+"; ",k.isNew=g,f},remove:function(){return delete a[c],b.data.arr.remove(a.$keys,c),d.cookie=c+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path="+(h.path||"/"),f}};if(h=b.is.obj(h)?h:{},!b.is.str(c)||""===c)throw b.$path+".cookie: A [String] value must be provided for the cookie name.";return l()?k.isNew=g:b.is.obj(i)&&(j=i),k.data=j,k}}(),!function(){function d(a,c){var d,e,h,i,j=b.is.obj(c)?c:{useSemicolon:c===f,encodeURI:f},k=j.encodeURI===g?function(a){return a}:encodeURIComponent,l=j.useSemicolon===f?"; ":"&",m="";for(d in a)if(a.hasOwnProperty(d))if(e=a[d],d=k(d.trim()),b.is.val(e))if(b.is.obj(e))for(h in e)if(e[h]instanceof Array)for(i=0;i<e[h].length;i++)m+=d+"["+k(h)+"]="+k(e[h][i])+l;else m+=d+"["+k(h)+"]="+k(e[h])+l;else if(Array.isArray(e))for(i=0;i<e.length;i++)m+=d+"="+k(e[i])+l;else b.is.fn(e)||(m+=d+"="+k(e)+l);else m+=d+"="+l;return m.trim().substr(0,m.length-1)}function e(a){var c,d,e,f,g,h,i={},j=function(a){return decodeURIComponent(a).replace(/\+/g," ")+""},k=/([^&;=]+)=?([^&;]*)/g;for(f=function(a){for(var c=1,d=arguments.length;c<d;c++)a[a.length]?(b.is.arr(a[a.length])?a[a.length].push(arguments[c]):a[a.length]=new Array(a[a.length],arguments[c]),a.length++):a[a.length++]=arguments[c]};d=k.exec(a);)if(c=d[1].indexOf("["),h=j(d[2]),c<0)e=j(d[1]).trim(),i[e]?i[e]instanceof Array?i[e].push(h):"object"==typeof i[e]?f(i[e],h):i[e]=new Array(i[e],h):i[e]=h?h:null;else{if(e=j(d[1].slice(0,c)).trim(),g=j(d[1].slice(c+1,d[1].indexOf("]",c))).trim(),b.eq.str(g,"length")&&(g=g.toUpperCase(),b.fn.call(b.resolve(b,"log.warn"),this,"'length' is a reserved name and cannot be used as a sub-key. Your sub-key has been changed to 'LENGTH'.")),!b.is.obj(i[e])||b.is.arr(i[e]))if(b.is.arr(i[e])){var l,m=i[e];for(i[e]={length:m.length},l=0;l<m.length;l++)i[e][l]=m[l]}else i[e]={0:i[e],length:1};g?i[e][g]?b.is.arr(i[e][g])?i[e][g].push(h):i[e][g]=new Array(i[e][g],h):i[e][g]=h:f(i[e],h)}return i}var a;b.queryString={ser:{ize:d,de:e},get:function(d,f){var g;return a=a||e(c.location.search.substring(1)),g=0===arguments.length?a:b.data.getKey(d,a,f)},parse:function(a){var c,d;return b.is.str(a,!0)&&(c=a.indexOf("?"),c>-1&&(d=e(a.substr(c+1)))),d}}}(),!function(){function e(c){a=b.extend(a,c)}function h(a,c,d,e){var h,i=XMLHttpRequest||ActiveXObject;try{h=new i("MSXML2.XMLHTTP.3.0")}catch(a){}return b.is.fn(e)&&(e={fn:e,arg:null}),h?(h.onreadystatechange=function(){4===h.readyState&&e.fn(200===h.status||0===h.status&&"file://"===a.substr(0,7),{text:h.responseText,data:b.fn.tryCatch(JSON.parse,null,h.responseText),url:a,verb:c,async:d},e.arg,h)},h.open(c,a,d===f)):e.fn(g,null,e.arg,h),h}function i(b,c){h(b,"GET",a.async,c).send()}function j(b,c){h(b,"POST",a.async,c).send()}function k(b,c){h(b,"PUT",a.async,c).send()}function l(b,c){h(b,"DELETE",a.async,c).send()}var a={async:f};b.extend(b.net,{ajax:{options:e,put:k,get:i,post:j,delete:l,head:function(b,c){h(b,"HEAD",a.async,c)}},create:k,read:i,update:j,delete:l}),b.$unstable.include=function(a,c,e){var g;e=e===f,c=b.is.fn(c)?{fn:c,arg:null}:b.mk.obj(c),g=h(a,"GET",e,function(a,e,f,g){a&&d.write(e.text),b.fn.call(c.fn,this,[a,e,c.arg,g])}),e&&(g.responseType="document"),g.send()},b.$unstable.includeDOM=function(a){var e,g,h,i,j=d.querySelectorAll(b.is.str(a,f)?a:"INCLUDE[src]");for(e=0;e<j.length;e++)g=j[e],i=g.getAttribute("onload"),b.is.str(i,f)&&(h=b.mk.json(i,{fn:c[i]}))}}(),!function(){function h(a,c,d){function j(a,c,d){var h,i,j,k=g;for(b.is.arr(c)?h=c:b.is.obj(c)&&(h=Object.keys(c),k=f),j=0;j<h.length;j++)i=h[j],k&&a.hasOwnProperty(i)&&(a[c[i]]=a[i]),d?a[i]=e:delete a[i]}var h,i=f;if(b.is.arr(a,f))for(h=0;h<a.length;h++)j(a[h],c,d);else b.is.obj(a)?j(a,c,d):i=g;return i}var a=c.localStorage,d=c.sessionStorage;b.data={storage:{set:function(c,e,f){var g=b.is.obj(e)?b.mk.json(e,e):e;(f?d:a).setItem(c,g)},get:function(c,e){var f=(e?d:a).getItem(c);return b.mk.json(f,f)},rm:function(b,c){(c?d:a).removeItem(b)},clear:function(b){(b?d:a).clear()}},map:function(a,c){function g(a){var b,d,f={};for(d=0;d<e.length;d++)b=e[d],f[c[b]]=a[b];return f}var d,f,e=b.is.obj(c)?Object.keys(c):null;if(e)if(b.is.arr(a))for(f=[],d=0;d<a.length;d++)f.push(g(a[d]));else b.is.obj(a)&&(f=g(a));return f},remap:function(a,c,d){var e=b.is.obj(c);return e&&(e=h(a,c,d)),e},cp:function(a,c){var d,e={};if(b.is.arr(c,!0)&&b.is.str(c[0]))for(d=0;d<c.length;d++)e[c[d]]=c[d];return b.data.map(a,e)},remove:function(a,c,d){var e;return b.is.str(c,f)&&(c=[c]),e=b.is.arr(c,f),e&&(e=h(a,c,d)),e},getKey:function(a,c,d){var e,f;if(b.is.obj(c))if(d){a=b.mk.str(a).toLowerCase();for(e in c)if(e.toLowerCase()===a){f=c[e];break}}else f=c[a];return f},getFirstByValue:function(a,c,d,g){var h=b.data.getByValue(a,c,d,g,f);return h?h.data[0]:e},getByValue:function(a,c,d,g,h){var i,j={indexes:[],data:[]};if(b.is.str(a)&&b.is.arr(d,f))for(i=0;i<d.length&&!(b.is.obj(d[i])&&b.eq.str(d[i][a],c,g)&&(j.data.push(d[i]),j.indexes.push(i),h));i++);return b.is.arr(j.data,f)?j:e},getByValues:function(a,c,d,g){var h,i,j,k={indexes:[],data:[]};if(b.is.arr(c,f))for(h=0;h<c.length;h++)if(j=b.data.getByValue(a,c[h],d,g))for(i=0;i<j.indexes.length;i++)k.indexes.push(j.indexes[i]),k.data.push(j.data[i]);return b.is.arr(k.data,f)?k:e},arr:{remove:function(a,c,d){var e,h=g;return b.is.arr(a,f)&&(e=a.indexOf(c),h=e>-1,h&&(3===arguments.length?a[e]=d:a.splice(e,1))),h},removeAll:function(a,c,d){var e,h,i,j=[],k=b.is.arr(c,f);if(b.is.arr(a,f))for(e=0;e<a.length;e++)if(k){for(i=g,h=0;h<c.length;h++)if(b.eq.str(a[e],c[h],d)){i=f;break}i||j.push(a[e])}else a[e]&&j.push(a[e]);return j},filter:function(a,c,d){var h,i,j,k,e=Object.keys(c);if(b.is.arr(a,f))if(b.is.arr(e,f))for(h=[],j=0;j<a.length;j++){for(i=f,k=0;k<e.length;k++){if(d&&b.resolve(a,j+"."+e[k])!=c[e[k]]){i=g;break}if(b.resolve(a,j+"."+e[k])!==c[e[k]]){i=g;break}}i&&h.push(a[j])}else h=a;return h}},str:{lpad:function(a,c,d){var e;if(e=a=b.mk.str(a),!(b.is.str(c)&&1===c.length&&b.is.num(d)&&d>-1))throw"core.data.str.lpad: `char` must represent a single character and `len` must be an integer greater than 0.";for(;e.length<d;)e=c+e;return e}}}}(),a=b.locate("ish"),b.$path=a.path,b.extend(b,a.ref),b.extend(a.ref,b)}();
