/*
ishJS Functionality
By: Nick Campbell
License: MIT
*/
!function(){"use strict";var a,d,b={$ver:"0.8.2017-01-24a",$ish:!0},c=window,e=!0,f=!1,g=Object.prototype.toString;Date.now||(Date.now=function(){return new Date}),b.resolve=function(){var a,c,g,h,i,j,k,l,m,n={allowFn:!0},o=arguments;if(o[0]===e?(m=e,h=o[1],g=o[2],o.length>3&&(l=e,c=o[3])):(m=f,h=o[0],g=o[1],o.length>2&&(l=e,c=o[2])),a=b.is.obj(h,n)?h:d,a&&(b.is.str(g)||b.is.arr(g,!0)&&b.is.str(g[0]))){for(i=b.is.arr(g)?g:g.split("."),j=0;j<i.length;j++)if(k=b.is.obj(a,n))if(i[j]in a)h=a,a=h[i[j]];else{if(!m){a=d;break}h=a,a=h[i[j]]={}}else if(m)h[i[j]]=a={};else if(j<i.length-1){a=d;break}l&&a&&(h[i[i.length-1]]=a=c)}return a},b.extend=function(){var a,c,d,e,f,g,h=arguments,i=b.is.bool(h[0]);for(i||b.is.num(h[0])?(e=i?-1:b.mk.int(h[0]),a=h[1],f=2):(e=0,a=h[0],f=1),a=b.is.obj(a,{allowFn:!0})?a:{};f<h.length;f++){c=h[f];for(d in c)if(Object.prototype.hasOwnProperty.call(c,d))if(b.is.arr(c[d]))for(a[d]=[],g=0;g<c[d].length;g++)a[d].push(0!==e&&b.is.obj(c[d][g])?b.extend(e-1,{},c[d][g]):c[d][g]);else a[d]=0!==e&&b.is.obj(c[d])?b.extend(e-1,{},c[d]):c[d]}return a},b.locate=function(d){var f,g,h,i,j=!1;for(h in c)if(f=c[h],c.hasOwnProperty(h)&&b.is.obj(f)&&d in f){g=f[d],d=b.is.str(g,e)?h+"."+g:h,j=!0;break}if(!j)for(g=document.getElementsByTagName("SCRIPT"),i=0;i<g.length;i++)if(f=b.queryString.parse(g[i].src),h=b.data.getKey(d,f,!0),b.is.str(h,!0)){d=h;break}return{path:d,ref:b.resolve(e,c,d)}},b.is={str:function(a,c,d){return b.mk.bool(!(!("string"==typeof a||a instanceof String)||c&&""===a||d&&""===b.mk.str(a).trim()))},date:function(a){var c=new Date(a);return b.mk.bool(a&&"[object Date]"===g.call(c)&&!isNaN(c.valueOf()))},num:function(a){return b.mk.bool(/^[-0-9]?[0-9]*(\.[0-9]{1,})?$/.test(a)&&!isNaN(parseFloat(a))&&isFinite(a))},int:function(a){var c=b.mk.float(a);return b.is.num(a)&&c%1===0},float:function(a){var c=b.mk.float(a);return b.is.num(a)&&c%1!==0},bool:function(a){return b.mk.bool("[object Boolean]"===g.call(a))},true:function(a){return b.mk.bool(a===e?e:"true"===(a+"").trim().toLowerCase())},fn:function(a){return b.mk.bool("[object Function]"===g.call(a))},obj:function(a,c){var d,g=c&&c===Object(c)?c:{},h=g.requiredKeys,i=g.nonEmpty===e,j=g.allowFn===e,k=b.mk.bool(a&&a===Object(a)&&(j||!b.is.fn(a)));if(k&&(k=b.mk.bool(!i||0!==Object.getOwnPropertyNames(a).length),k&&h))for(d=0;d<h.length;d++)if(!a.hasOwnProperty(h[0])){k=f;break}return k},arr:function(a,c){return b.mk.bool("[object Array]"===g.call(a)&&(!c||a.length>0))},val:function(a){return b.mk.bool(a!==d&&null!==a)},type:function(a,b){try{return a instanceof b}catch(a){return f}},json:function(a){try{return JSON.parse(a),e}catch(a){return f}},dom:function(a){return b.mk.bool(a&&b.is.str(a.tagName)&&""!==a.tagName&&b.is.fn(a.getAttribute))}},b.mk={str:function(a,b){var c=a+"";return a&&c?c:arguments.length>1?b:""},date:function(a,c){return b.is.date(a)?new Date(a):arguments.length>1?c:new Date},int:function(a,b){var c=parseInt(a,10);return isNaN(c)?arguments.length>1?b:0:c},float:function(a,b){var c=parseFloat(a,10);return isNaN(c)?arguments.length>1?b:0:c},arr:function(a,c){return b.is.arr(a)?a:arguments.length>1?c:[]},obj:function(a,c){var d=b.is.fn(a)&&b.is.obj(a,{nonEmpty:e,allowFn:e});return d&&(a=b.extend({},a)),d||b.is.obj(a)?a:arguments.length>1?c:{}},bool:function(a){return a?e:f},age:function(a){var c,d=-1;return b.is.date(a)&&(c=new Date(Date.now()-b.mk.date(a,null)),d=Math.abs(c.getUTCFullYear()-1970)),d},yyyymmdd:function(a,c){var d=b.mk.date(a,arguments.length>1?c:new Date);return b.is.date(d)?d.getFullYear()+"/"+b.data.str.lpad(d.getMonth()+1,"0",2)+"/"+b.data.str.lpad(d.getDate(),"0",2):""},dateOnly:function(a,c){return b.mk.date(b.mk.yyyymmdd.apply(this,arguments)+" 00:00:00")},json:function(a,c){var d=arguments.length>1?c:{};if(b.is.str(a,e))try{d=JSON.parse(a)}catch(a){}else if(b.is.obj(a))try{d=JSON.stringify(a)}catch(a){}return d}},b.eq={date:function(a,c){var d=b.mk.date(a,null),e=b.mk.date(c,null);return b.is.date(d)&&b.is.date(e)&&d<=e&&d>=e},num:function(a,c){var d=f;return b.is.num(a)&&b.is.num(c)&&(d=b.mk.float(a)===b.mk.float(c)),d},str:function(a,c,d){return a=b.mk.str(a,""),c=b.mk.str(c,""),d!==f?a.toLowerCase()===c.toLowerCase():a===c}},b.comp={date:function(a,c){var e=d,f=b.mk.date(a,null),g=arguments.length<2?new Date:b.mk.date(c,null);return b.is.date(f)&&b.is.date(g)&&(e=f<g?-1:f>g?1:0),e},num:function(a,c){var e=d,f=b.mk.float(a,null),g=b.mk.float(c,null);return b.is.num(f)&&b.is.num(g)&&(e=f<g?-1:f>g?1:0),e},str:function(a,c){var d=f,g=b.mk.str(a),h=b.mk.str(c);return g===h?d=e:g.trim().toLowerCase()===h.trim().toLowerCase()&&(d=1),d}},b.fn={call:function(a,c,d){if(b.is.fn(a))return a.apply(c||this,b.is.arr(d)?d:[d])},tryCatch:function(a,c,d,e,f){var g={result:e,error:null};try{g.result=a.apply(c||this,b.is.arr(d)?d:[d])}catch(a){g.error=a}return f?g:g.result},throttle:function(a,c,d){var e,g,h,i=null,j=0;d=b.mk.obj(d);var k=function(){j=d.leading===f?0:Date.now(),i=null,h=a.apply(e,g),i||(e=g=null)};return function(){var b,l=Date.now();return j||d.leading!==f||(j=l),b=c-(l-j),e=this,g=arguments,b<=0||b>c?(i&&(clearTimeout(i),i=null),j=l,h=a.apply(e,g),i||(e=g=null)):i||d.trailing===f||(i=setTimeout(k,b)),h}},debounce:function(a,b,c){var d,e,f,g,h,i=function(){var j=Date.now()-g;j<b&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){var j=c&&!d;return f=this,e=arguments,g=Date.now(),d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},poll:function(a,c,d,e,f,g){var h=Number(new Date)+(e||2e3);f=f||100,!function e(){a===!0&&b.is.fn(c)?c(g):b.fn.call(a,this,g)?c(g):Number(new Date)<h?setTimeout(e,f):b.is.fn(d)&&d(new Error("timed out for "+c+": "+arguments),g)}()},noop:function(){},once:function(a,c,d){var e;return function(){return b.is.fn(a)&&(e=a.apply(c||this,b.is.arr(d)?d:[d]),a=null),e}}},!function(){var a,c;b.net={ping:function(a){c||(c=document.createElement("iframe")),c.src=a},absoluteUrl:function(b){return a||(a=document.createElement("a")),a.href=b,a.href}}}(),!function(){function g(c,d){c<=a.logLevel&&(b.is.str(a.url,e)&&b.ui.ping(a.url),b.fn.call(a.callback,this,d))}function h(c,e,f,h,i){return g(d.error,arguments),b.mk.bool(a.surpressErrors)}var a,d={error:1,warn:2,log:3};b.log={options:function(g){a=b.extend({severity:d,logLevel:d.error,logAllErrors:f,surpressErrors:e,callback:null,url:null},g),a.logAllErrors?b.fn.tryCatch(function(){c.onerror=h},this,[],{}):c.onerror=null},raise:function(a){throw g(d.error,a),a},warn:function(){g(d.warn,arguments);try{c.console&&b.is.fn(c.console.warn)?c.console.warn.apply(this,arguments):b.log.console.apply(this,arguments)}catch(a){}},console:function(){g(d.log,arguments);try{c.console.log.apply(this,arguments)}catch(a){}}}}(),!function(){var a={$keys:[]};b.cookie=function(c,g,h){function k(){var a,b,d=document.cookie.split(";");for(a=0;a<d.length;a++)if(b=d[a].indexOf("="),c===d[a].substr(0,b).replace(/^\s+|\s+$/g,"")){j.original=decodeURIComponent(d[a].substr(b+1));try{i=j.original?JSON.parse(j.original):{}}catch(a){i={}}return e}return f}var i,j={name:c,original:null,string:function(){return JSON.stringify(j.data)},data:null,isNew:e,set:function(a,b,h){var i;return a===d&&(a=1008e4),a>0&&(i=new Date,i.setSeconds(i.getSeconds()+a)),b=b||"/",g.maxAge=a,g.path=b,g.domain=h,document.cookie=c+"="+encodeURIComponent(j.string())+"; path="+b+(a>0?"; max-age="+a:"")+(i?"; expires="+i.toUTCString():"")+(h?"; domain="+h:"")+"; ",j.isNew=f,e},remove:function(){return delete a[c],b.data.arr.remove(a.$keys,c),document.cookie=c+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path="+(g.path||"/"),e}};if(g=b.is.obj(g)?g:{},!b.is.str(c)||""===c)throw b.$path+".cookie: A [String] value must be provided for the cookie name.";return k()?j.isNew=f:b.is.obj(h)&&(i=h),j.data=i,j}}(),!function(){function d(a,c){var d,g,h,i,j=b.is.obj(c)?c:{useSemicolon:c===e,encodeURI:e},k=j.encodeURI===f?function(a){return a}:encodeURIComponent,l=j.useSemicolon===e?"; ":"&",m="";for(d in a)if(a.hasOwnProperty(d))if(g=a[d],d=k(d.trim()),b.is.val(g))if(b.is.obj(g))for(h in g)if(g[h]instanceof Array)for(i=0;i<g[h].length;i++)m+=d+"["+k(h)+"]="+k(g[h][i])+l;else m+=d+"["+k(h)+"]="+k(g[h])+l;else if(Array.isArray(g))for(i=0;i<g.length;i++)m+=d+"="+k(g[i])+l;else b.is.fn(g)||(m+=d+"="+k(g)+l);else m+=d+"="+l;return m.trim().substr(0,m.length-1)}function g(a){var c,d,e,f,g,h,i={},j=function(a){return decodeURIComponent(a).replace(/\+/g," ")+""},k=/([^&;=]+)=?([^&;]*)/g;for(f=function(a){for(var c=1,d=arguments.length;c<d;c++)a[a.length]?(b.is.arr(a[a.length])?a[a.length].push(arguments[c]):a[a.length]=new Array(a[a.length],arguments[c]),a.length++):a[a.length++]=arguments[c]};d=k.exec(a);)if(c=d[1].indexOf("["),h=j(d[2]),c<0)e=j(d[1]).trim(),i[e]?i[e]instanceof Array?i[e].push(h):"object"==typeof i[e]?f(i[e],h):i[e]=new Array(i[e],h):i[e]=h?h:null;else{if(e=j(d[1].slice(0,c)).trim(),g=j(d[1].slice(c+1,d[1].indexOf("]",c))).trim(),b.eq.str(g,"length")&&(g=g.toUpperCase(),b.fn.call(b.resolve(b,"log.warn"),this,"'length' is a reserved name and cannot be used as a sub-key. Your sub-key has been changed to 'LENGTH'.")),!b.is.obj(i[e])||b.is.arr(i[e]))if(b.is.arr(i[e])){var l,m=i[e];for(i[e]={length:m.length},l=0;l<m.length;l++)i[e][l]=m[l]}else i[e]={0:i[e],length:1};g?i[e][g]?b.is.arr(i[e][g])?i[e][g].push(h):i[e][g]=new Array(i[e][g],h):i[e][g]=h:f(i[e],h)}return i}var a;b.queryString={ser:{ize:d,de:g},get:function(d,e){var f;return a=a||g(c.location.search.substring(1)),f=0===arguments.length?a:b.data.getKey(d,a,e)},parse:function(a){var c,d;return b.is.str(a,!0)&&(c=a.indexOf("?"),c>-1&&(d=g(a.substr(c+1)))),d}}}(),!function(){function c(c){a=b.extend(a,c)}function d(a,c,d,g){var h,i=XMLHttpRequest||ActiveXObject;try{h=new i("MSXML2.XMLHTTP.3.0")}catch(a){}return b.is.fn(g)&&(g={fn:g,arg:null}),h?(h.onreadystatechange=function(){4===h.readyState&&g.fn(200===h.status||0===h.status&&"file://"===a.substr(0,7),{text:h.responseText,data:b.fn.tryCatch(JSON.parse,null,h.responseText)},g.arg,h)},h.open(c,a,d===e),h.send()):g.fn(f,null,g.arg,h),h}function g(b,c){d(b,"GET",a.async,c)}function h(b,c){d(b,"POST",a.async,c)}function i(b,c){d(b,"PUT",a.async,c)}function j(b,c){d(b,"DELETE",a.async,c)}var a={async:e};b.extend(b.net,{ajax:{options:c,put:i,get:g,post:h,delete:j,head:function(b,c){d(b,"HEAD",a.async,c)}},create:i,read:g,update:h,delete:j})}(),!function(){function h(a,c,g){function j(a,c,g){var h,i,j,k=f;for(b.is.arr(c)?h=c:b.is.obj(c)&&(h=Object.keys(c),k=e),j=0;j<h.length;j++)i=h[j],k&&a.hasOwnProperty(i)&&(a[c[i]]=a[i]),g?a[i]=d:delete a[i]}var h,i=e;if(b.is.arr(a,e))for(h=0;h<a.length;h++)j(a[h],c,g);else b.is.obj(a)?j(a,c,g):i=f;return i}var a=c.localStorage,g=c.sessionStorage;b.data={storage:{set:function(c,d,e){var f=b.is.obj(d)?b.mk.json(d,d):d;(e?g:a).setItem(c,f)},get:function(c,d){var e=(d?g:a).getItem(c);return b.mk.json(e,e)},rm:function(b,c){(c?g:a).removeItem(b)},clear:function(b){(b?g:a).clear()}},map:function(a,c){function g(a){var b,d,f={};for(d=0;d<e.length;d++)b=e[d],f[c[b]]=a[b];return f}var d,f,e=b.is.obj(c)?Object.keys(c):null;if(e)if(b.is.arr(a))for(f=[],d=0;d<a.length;d++)f.push(g(a[d]));else b.is.obj(a)&&(f=g(a));return f},remap:function(a,c,d){var e=b.is.obj(c);return e&&(e=h(a,c,d)),e},cp:function(a,c){var d,e={};if(b.is.arr(c,!0)&&b.is.str(c[0]))for(d=0;d<c.length;d++)e[c[d]]=c[d];return b.data.map(a,e)},remove:function(a,c,d){var f;return b.is.str(c,e)&&(c=[c]),f=b.is.arr(c,e),f&&(f=h(a,c,d)),f},getKey:function(a,c,d){var e,f;if(b.is.obj(c))if(d){a=b.mk.str(a).toLowerCase();for(e in c)if(e.toLowerCase()===a){f=c[e];break}}else f=c[a];return f},getFirstByValue:function(a,c,f,g){var h=b.data.getByValue(a,c,f,g,e);return h?h.data[0]:d},getByValue:function(a,c,f,g,h){var i,j={indexes:[],data:[]};if(b.is.str(a)&&b.is.arr(f,e))for(i=0;i<f.length&&!(b.is.obj(f[i])&&b.eq.str(f[i][a],c,g)&&(j.data.push(f[i]),j.indexes.push(i),h));i++);return b.is.arr(j.data,e)?j:d},getByValues:function(a,c,f,g){var h,i,j,k={indexes:[],data:[]};if(b.is.arr(c,e))for(h=0;h<c.length;h++)if(j=b.data.getByValue(a,c[h],f,g))for(i=0;i<j.indexes.length;i++)k.indexes.push(j.indexes[i]),k.data.push(j.data[i]);return b.is.arr(k.data,e)?k:d},arr:{remove:function(a,c,d){var g,h=f;return b.is.arr(a,e)&&(g=a.indexOf(c),h=g>-1,h&&(3===arguments.length?a[g]=d:a.splice(g,1))),h},removeAll:function(a,c,d){var g,h,i,j=[],k=b.is.arr(c,e);if(b.is.arr(a,e))for(g=0;g<a.length;g++)if(k){for(i=f,h=0;h<c.length;h++)if(b.eq.str(a[g],c[h],d)){i=e;break}i||j.push(a[g])}else a[g]&&j.push(a[g]);return j},filter:function(a,c,d){var h,i,j,k,g=Object.keys(c);if(b.is.arr(a,e))if(b.is.arr(g,e))for(h=[],j=0;j<a.length;j++){for(i=e,k=0;k<g.length;k++){if(d&&b.resolve(a,j+"."+g[k])!=c[g[k]]){i=f;break}if(b.resolve(a,j+"."+g[k])!==c[g[k]]){i=f;break}}i&&h.push(a[j])}else h=a;return h}},str:{lpad:function(a,c,d){var e;if(e=a=b.mk.str(a),!(b.is.str(c)&&1===c.length&&b.is.num(d)&&d>-1))throw"core.data.str.lpad: `char` must represent a single character and `len` must be an integer greater than 0.";for(;e.length<d;)e=c+e;return e}}}}(),a=b.locate("ish"),b.$path=a.path,b.extend(b,a.ref),b.extend(a.ref,b)}();
